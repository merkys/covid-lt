#!/usr/bin/python3

import argparse, re, sys

parser = argparse.ArgumentParser()
parser.add_argument('files', nargs='*')
args = parser.parse_args()

files = args.files
if len(files) == 0:
    files = [sys.stdin]

for file in files:
    pdb_id   = None
    molecule = None
    if isinstance(file, str):
        file = open(file, 'r')
    for line in file:
        line = re.sub("\s*;?\s*\n$", "", line)
        if re.match("HEADER ", line):
            pdb_id = line[62:66]
        elif re.match("COMPND ", line):
            if line[11:20] == 'MOLECULE:':
                molecule = line[21:]
            elif line[11:17] == 'CHAIN:':
                for chain in re.split("\s*,\s*", line[18:]):
                    print("{}\t{}\t{}".format(pdb_id, chain, molecule))
