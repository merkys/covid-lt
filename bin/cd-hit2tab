#!/usr/bin/python3

import re, sys

files = sys.argv[1:]
if len(files) == 0:
    files = [sys.stdin]

for file in files:
    if isinstance(file, str):
        file = open(file, 'r')
    cluster_nr = None
    for line in file:
        if line.startswith('>Cluster'):
            _, cluster_nr = line.rstrip().split(' ')
        else:
            match = re.match('\d+\s+\d+aa, >([0-9a-zA-Z]{4})_(.)', line)
            if match:
                print(match.group(1).upper(), match.group(2), cluster_nr, sep='\t')
