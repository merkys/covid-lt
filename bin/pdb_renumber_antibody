#!/usr/bin/env python3

from anarci import run_anarci
from pdbio.pdbfile import PDBFile
from warnings import warn
import sys

files = sys.argv[1:]
file = files[0] # for now

pdb = PDBFile(file)

for chain in pdb.chains():
    sequence = pdb.sequence(chain)
    _, numbered, details, _ = run_anarci([(chain, sequence)], scheme='chothia', allow=set(['H', 'L']))
    numbered = numbered[0]
    details = details[0]
    if numbered is None:
        continue
    if len(numbered) > 1:
        warn('Chain {} has more than one alignments, not sure what to do' % chain)
        continue
    numbered = numbered[0]
    details = details[0]
    chain_type = details['chain_type'] # To be somehow stored in the resulting PDB file
    print(numbered, details)
