#!/usr/bin/env python3

from pdbio.pdbfile import PDBFile
from math import ceil, floor
import sys

pdb = PDBFile(sys.argv[1]) # For now
coords = []

for chain in pdb:
    for residue in chain:
        for atom in residue:
            coords.append(atom.coords())

box = [min(coord[0] for coord in coords), max(coord[0] for coord in coords),
       min(coord[1] for coord in coords), max(coord[1] for coord in coords),
       min(coord[2] for coord in coords), max(coord[2] for coord in coords)]

dcel = 1
if len(sys.argv) > 2:
    dcel = float(sys.argv[2])

box[0] = floor(box[0])
box[1] = ceil(box[1])
box[2] = floor(box[2])
box[3] = ceil(box[3])
box[4] = floor(box[4])
box[5] = ceil(box[5])

print('NCLX', (box[1]-box[0])/dcel, 'XBCEN', (box[0]+box[1])/2, '-')
print('NCLY', (box[3]-box[2])/dcel, 'YBCEN', (box[2]+box[3])/2, '-')
print('NCLZ', (box[5]-box[4])/dcel, 'ZBCEN', (box[4]+box[5])/2, '-')
