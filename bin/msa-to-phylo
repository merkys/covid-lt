#!/usr/bin/Rscript --vanilla

# Depict a multiple sequence alignment via an unrooted phylogenetic tree.
# Implemented according to https://a-little-book-of-r-for-bioinformatics.readthedocs.io/en/latest/src/chapter5.html

library('ape')
library('seqinr')

file = '/dev/stdin'

msa = read.alignment(file, format="fasta")
msa_dist = dist.alignment(msa)
T = nj(msa_dist)

svg("/dev/stdout")
plot.phylo(T, type="unrooted", no.margin=TRUE)
