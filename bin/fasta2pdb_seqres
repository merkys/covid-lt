#!/usr/bin/env python3

from Bio import SeqIO
from Bio.SeqUtils import seq3
from math import ceil
import sys

files = sys.argv[1:]
if len(files) == 0:
    files = [sys.stdin]

for file in files:
    for chain in SeqIO.parse(file, 'fasta'):
        for line in range(0, ceil(len(chain)/13)):
            residues = [seq3(x).upper() for x in chain[13*line:13*(line+1)]]
            print('SEQRES', '% 3d' % (line+1), chain.id[-1], '% 4d ' % len(chain), *residues)
