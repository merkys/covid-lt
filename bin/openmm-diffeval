#!/bin/bash

MUT=$1

PARTNER1=$2
PARTNER2=$3

CHAINS=${PARTNER1}${PARTNER2}

(

    for FILE in ${MUT}_${CHAINS}.pdb ${MUT}_${CHAINS}_wt.pdb
    do
        sed 's/HSE/HIS/g' $FILE \
            | ../../master/bin/pdb_openmm_minimize --forcefield amber99sb.xml --print-forces --max-iterations 0 --force-unit kcal/mol --split-nonbonded-force \
            | grep ^LJForce \
            | cut -f 2
    done

    for PARTNER in $PARTNER1 $PARTNER2
    do
        for FILE in ${MUT}_${CHAINS}_wt.pdb ${MUT}_${CHAINS}.pdb
        do
            sed 's/HSE/HIS/g' $FILE \
                | bin/pdb_select --chain ${PARTNER} \
                | ../../master/bin/pdb_openmm_minimize --forcefield amber99sb.xml --print-forces --max-iterations 0 --force-unit kcal/mol --split-nonbonded-force \
                | grep ^LJForce \
                | cut -f 2
        done
    done

) | perl -le 'while (<>) {print $_ * (-1) ** ($. + 1)}'
