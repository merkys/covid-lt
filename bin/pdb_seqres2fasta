#!/usr/bin/env python3

# NB: FASTA sequences from PDB files with DBREF1/DBREF2 do not get PDB IDs in their headers.
# See https://github.com/biopython/biopython/issues/3887

from Bio import PDB, SeqIO
import sys, warnings

warnings.filterwarnings('ignore', category=PDB.PDBExceptions.PDBConstructionWarning)

progname = sys.argv[0]
type = progname[progname.find('_')+1:progname.find('2')]

files = sys.argv[1:]
if len(files) == 0:
    files = [sys.stdin]

for file in files:
    try:
        SeqIO.convert(file, 'pdb-' + type, sys.stdout, 'fasta')
    except ValueError as e:
        if e.args[0] != "Empty file.":
            raise e
