#!/usr/bin/python3

# Extract clusters from cd-hit output

import re, sys

files = sys.argv[1:]
if len(files) == 0:
    files = [sys.stdin]

for file in files:
    if isinstance(file, str):
        file = open(file, 'r')
    cluster = None
    for line in file:
        if re.match('>Cluster', line):
            if cluster is None:
                cluster = 0
            else:
                cluster += 1
        else:
            match = re.match('\d+\s+\d+aa, >([A-Za-z0-9]{4})_(.)', line)
            if match:
                print(match.group(1).upper(), match.group(2), cluster, sep="\t")
