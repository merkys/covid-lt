#!/usr/bin/python3

import re, sys

files = sys.argv[1:]
if len(files) == 0:
    files = [sys.stdin]

for file in files:
    if isinstance(file, str):
        file = open(file, 'r')
    in_main = False
    for line in file:
        if in_main:
            if re.match('  ------ inclusion threshold', line) or line == '\n':
                break
            pdb_id = line[60:64].upper()
            chain = line[65]
            print(pdb_id, chain, sep="\t")
        elif re.match('    ------- ------', line):
            in_main = True
